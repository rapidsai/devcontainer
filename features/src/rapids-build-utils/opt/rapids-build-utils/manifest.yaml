x-git-defaults: &git_defaults
    host: github
    tag: branch-24.04
    upstream: rapidsai

x-python-wheel-no-build-isolation: &python_wheel_no_build_isolation
  args:
    wheel: --no-build-isolation

repos:

- name: rmm
  path: rmm
  git: {<<: *git_defaults, repo: rmm}
  cpp:
    - name: rmm
      sub_dir: ""
  python:
    - name: rmm
      sub_dir: python
      <<: *python_wheel_no_build_isolation

- name: ucxx
  path: ucxx
  git: {<<: *git_defaults, repo: ucxx, tag: branch-0.37}
  cpp:
    - name: ucxx
      sub_dir: cpp
      depends: [rmm]
      args: |
        -DUCXX_ENABLE_PYTHON=ON
        -DUCXX_ENABLE_RMM=ON
  python:
    - name: ucxx
      sub_dir: python
      <<: *python_wheel_no_build_isolation

- name: kvikio
  path: kvikio
  git: {<<: *git_defaults, repo: kvikio}
  cpp:
    - name: KvikIO
      sub_dir: cpp
      depends: [rmm]
  python:
    - name: kvikio
      sub_dir: python
      <<: *python_wheel_no_build_isolation

- name: cudf
  path: cudf
  git: {<<: *git_defaults, repo: cudf}
  cpp:
    - name: cudf
      sub_dir: cpp
      depends: [rmm, KvikIO]
    - name: cudf_kafka
      sub_dir: cpp/libcudf_kafka
      depends: [rmm, KvikIO, cudf]
  python:
    - name: cudf
      sub_dir: python/cudf
      <<: *python_wheel_no_build_isolation
    - name: dask_cudf
      sub_dir: python/dask_cudf
      <<: *python_wheel_no_build_isolation
    - name: cudf_kafka
      sub_dir: python/cudf_kafka
      <<: *python_wheel_no_build_isolation
    - name: custreamz
      sub_dir: python/custreamz
      <<: *python_wheel_no_build_isolation

- name: raft
  path: raft
  git: {<<: *git_defaults, repo: raft}
  cpp:
    - name: raft
      sub_dir: cpp
      depends: [rmm]
  python:
    - name: pylibraft
      sub_dir: python/pylibraft
      <<: *python_wheel_no_build_isolation
    - name: raft-dask
      sub_dir: python/raft-dask
      <<: *python_wheel_no_build_isolation

- name: cumlprims_mg
  path: cumlprims_mg
  git: {<<: *git_defaults, repo: cumlprims_mg}
  cpp:
    - name: cumlprims_mg
      sub_dir: cpp
      depends: [rmm, raft]

- name: cuml
  path: cuml
  git: {<<: *git_defaults, repo: cuml}
  cpp:
    - name: cuml
      sub_dir: cpp
      depends: [rmm, raft, cumlprims_mg]
  python:
    - name: cuml
      sub_dir: python
      <<: *python_wheel_no_build_isolation

- name: cugraph-ops
  path: cugraph-ops
  git: {<<: *git_defaults, repo: cugraph-ops}
  cpp:
    - name: cugraph-ops
      sub_dir: cpp
      depends: [rmm, raft]
    - name: cugraph-ops-internal
      sub_dir: cpp_internal
      depends: [rmm, raft, cugraph-ops]
  python:
    - name: pylibcugraphops
      sub_dir: pylibcugraphops
      <<: *python_wheel_no_build_isolation
    - name: pylibcugraphops_internal
      sub_dir: pylibcugraphops_internal
      <<: *python_wheel_no_build_isolation

- name: wholegraph
  path: wholegraph
  git: {<<: *git_defaults, repo: wholegraph}
  cpp:
    - name: wholegraph
      sub_dir: cpp
      depends: [rmm, raft]
  python:
    - name: wholegraph
      sub_dir: python/pylibwholegraph
      <<: *python_wheel_no_build_isolation

- name: cugraph
  path: cugraph
  git: {<<: *git_defaults, repo: cugraph}
  cpp:
    - name: cugraph
      sub_dir: cpp
      depends: [rmm, raft, cugraph-ops]
    - name: cugraph_etl
      sub_dir: cpp/libcugraph_etl
      depends: [rmm, raft, cudf, cugraph-ops, cugraph]
  python:
    - name: pylibcugraph
      sub_dir: python/pylibcugraph
      <<: *python_wheel_no_build_isolation
    - name: cugraph
      sub_dir: python/cugraph
      <<: *python_wheel_no_build_isolation
    - name: nx-cugraph
      sub_dir: python/nx-cugraph
      <<: *python_wheel_no_build_isolation
    - name: cugraph-dgl
      sub_dir: python/cugraph-dgl
      <<: *python_wheel_no_build_isolation
    - name: cugraph-equivariant
      sub_dir: python/cugraph-equivariant
      <<: *python_wheel_no_build_isolation
    - name: cugraph_pyg
      sub_dir: python/cugraph-pyg
      <<: *python_wheel_no_build_isolation
    - name: cugraph-service-client
      sub_dir: python/cugraph-service/client
      <<: *python_wheel_no_build_isolation
    - name: cugraph-service-server
      sub_dir: python/cugraph-service/server
      <<: *python_wheel_no_build_isolation

- name: cuspatial
  path: cuspatial
  git: {<<: *git_defaults, repo: cuspatial}
  cpp:
    - name: cuspatial
      sub_dir: cpp
      depends: [rmm, cudf]
  python:
    - name: cuproj
      sub_dir: python/cuproj
      <<: *python_wheel_no_build_isolation
    - name: cuspatial
      sub_dir: python/cuspatial
      <<: *python_wheel_no_build_isolation
